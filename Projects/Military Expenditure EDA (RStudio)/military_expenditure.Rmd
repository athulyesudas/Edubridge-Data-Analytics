## EDA on Military Expenditure

## You can download the dataset from this link:    https://www.kaggle.com/datasets/prasertk/military-expenditure-by-country-from-19702020

## This dataset contains Military Expenditure of Whole World from year 1970 to 2020

## OBJECTIVE:
   1. Find the top 10 countries with highest total military spending.
   2. Find the top 10 countries with lowest total military spending.
   3. Find the top 10 countries with highest military spending in each decade.



## Importing Libraries
```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
library(choroplethr)
library(choroplethrMaps)
```
```{r}
getwd()
```
```{r}
d = read.csv('military expenditure.csv')  # for reading data from csv file
```
```{r}
d
```
```{r}
str(d)  # structure of data
```
```{r}
summary(d)
```
```{r}
glimpse(d)
```
```{r}
sample_n(d,5)
```
```{r}
sample_frac(d,0.2)
```
```{r}
distinct(d)
```
```{r}
length(distinct(d))
```
```{r}
dim(d)
```
```{r}
dim(distinct(d))  # this proves no duplicates
```
```{r}
d
```
```{r}
d = select(d, -iso3c, -iso2c, -Military.expenditure....of.general.government.expenditure.,-Military.expenditure....of.GDP. )
d
```
```{r}
total_expenditure_of_each_country = aggregate(Military.expenditure..current.USD. ~ country, d, sum)
total_expenditure_of_each_country
```
```{r}
x =  arrange(total_expenditure_of_each_country, Military.expenditure..current.USD.)
x

```
```{r}
y =  arrange(total_expenditure_of_each_country, -Military.expenditure..current.USD.)
y
```

```{r}
y1 = y[!(y$country == 'World' | y$country == 'High income' | y$country == 'OECD members' | y$country == 'Post-demographic dividend' | y$country == 'North America' | y$country == 'IDA & IBRD total' | y$country == 'Low & middle income' | y$country == 'Middle income' | y$country == 'IBRD only' |  y$country == 'Europe & Central Asia' | y$country == 'European Union' | y$country == 'East Asia & Pacific' | y$country == 'Late-demographic dividend' | y$country == 'Upper middle income' | y$country == 'Euro area' | y$country == 'Early-demographic dividend' | y$country == 'Middle East & North Africa' | y$country == 'East Asia & Pacific (excluding high income)' | y$country == 'East Asia & Pacific (IDA & IBRD countries)' | y$country == 'Lower middle income' |  y$country == 'Arab World' | y$country == 'Europe & Central Asia (IDA & IBRD countries)' | y$country =='Europe & Central Asia (excluding high income)' | y$country == 'Latin America & Caribbean' | y$country == 'Latin America & the Caribbean (IDA & IBRD countries)' | y$country == 'South Asia' | y$country == 'South Asia (IDA & IBRD)' | y$country == 'Latin America & Caribbean (excluding high income)' | y$country == 'Middle East & North Africa (excluding high income)' | y$country == 'Middle East & North Africa (IDA & IBRD countries)' | y$country == 'IDA total' | y$country == 'Fragile and conflict affected situations' | y$country == 'Sub-Saharan Africa' | y$country == 'Sub-Saharan Africa (IDA & IBRD countries)' | y$country == 'Sub-Saharan Africa (excluding high income)' | y$country == 'IDA only' | y$country == 'Pre-demographic dividend' | y$country == 'Africa Eastern and Southern' | y$country == 'Least developed countries: UN classification' | y$country == 'Central Europe and the Baltics' | y$country == 'IDA blend' | y$country == 'Low income' | y$country == 'Heavily indebted poor countries (HIPC)' | y$country == 'Africa Western and Central' | y$country == 'Small states' | y$country == 'Other small states') ,]

y1     # dropping all rows which are not countries
```
```{r}
row.names(y1) = NULL  # for removing index
y1
```




```{r}
sum(y1$Military.expenditure..current.USD.)  # total expenditure of whole world
```




```{r}
highest_military_spending = head(y1,10) # top 10 countries with highest military spending
highest_military_spending
```

```{r}
lowest_military_spending = tail(y1,10) # top 10 countries with lowest military spending
lowest_military_spending
```


```{r}

highest_expenditure_plot  = ggplot(highest_military_spending, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Top 10 Countries with Highest Military Spending(1970-2020)') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


highest_expenditure_plot.labs = highest_expenditure_plot + labs(title = "Top 10 Countries with Highest Military Spending(1970-2020)", x = "Country", y = "Military Expenditure in US Dollars")
highest_expenditure_plot.labs


```

```{r}
lowest_expenditure_plot  = ggplot(lowest_military_spending, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Top 10 Countries with Lowest Military Spending(1970-2020)') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


lowest_expenditure_plot.labs = lowest_expenditure_plot + labs(title = "Top 10 Countries with Lowest Military Spending(1970-2020)", x = "Country", y = "Military Expenditure in US Dollars")
lowest_expenditure_plot.labs
```

```{r}
# Basic piechart
H_Plot= ggplot(highest_military_spending, aes(x="", y=Military.expenditure..current.USD., fill=country)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  theme_void() # remove background, grid, numeric labels
  
         
H_Plot.labs = H_Plot + labs(title = "Top 10 Countries with Highest Military Spending(1970-2020)")
H_Plot.labs

```

```{r}
# Basic piechart
L_Plot= ggplot(lowest_military_spending, aes(x="", y=Military.expenditure..current.USD., fill=country)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  theme_void() # remove background, grid, numeric labels
  
         
L_Plot.labs = L_Plot + labs(title = "Top 10 Countries with Lowest Military Spending(1970-2020)")
L_Plot.labs
```


```{r}
d1 = d[!(d$country == 'World' | d$country == 'High income' | d$country == 'OECD members' | d$country == 'Post-demographic dividend' | d$country == 'North America' | d$country == 'IDA & IBRD total' | d$country == 'Low & middle income' | d$country == 'Middle income' | d$country == 'IBRD only' |  d$country == 'Europe & Central Asia' | d$country == 'European Union' | d$country == 'East Asia & Pacific' | d$country == 'Late-demographic dividend' | d$country == 'Upper middle income' | d$country == 'Euro area' | d$country == 'Early-demographic dividend' | d$country == 'Middle East & North Africa' | d$country == 'East Asia & Pacific (excluding high income)' | d$country == 'East Asia & Pacific (IDA & IBRD countries)' | d$country == 'Lower middle income' |  d$country == 'Arab World' | d$country == 'Europe & Central Asia (IDA & IBRD countries)' | d$country =='Europe & Central Asia (excluding high income)' | d$country == 'Latin America & Caribbean' | d$country == 'Latin America & the Caribbean (IDA & IBRD countries)' | d$country == 'South Asia' | d$country == 'South Asia (IDA & IBRD)' | d$country == 'Latin America & Caribbean (excluding high income)' | d$country == 'Middle East & North Africa (excluding high income)' | d$country == 'Middle East & North Africa (IDA & IBRD countries)' | d$country == 'IDA total' | d$country == 'Fragile and conflict affected situations' | d$country == 'Sub-Saharan Africa' | d$country == 'Sub-Saharan Africa (IDA & IBRD countries)' | d$country == 'Sub-Saharan Africa (excluding high income)' | d$country == 'IDA only' | d$country == 'Pre-demographic dividend' | d$country == 'Africa Eastern and Southern' | d$country == 'Least developed countries: UN classification' | d$country == 'Central Europe and the Baltics' | d$country == 'IDA blend' | d$country == 'Low income' | d$country == 'Heavily indebted poor countries (HIPC)' | d$country == 'Africa Western and Central' | d$country == 'Small states' | d$country == 'Other small states') ,]

d1
```


```{r}
d2 = select(d1, -adminregion, -incomeLevel,)
d2
```

```{r}
year_1970 = d2 %>% filter(year == 1970)  # for single subset
year_1970
```

```{r}
year_wise = split(d2, d2$year)   # for multiple subsets
new_names = c('1970','1971','1972','1973','1974','1975','1976','1977','1978','1979','1980','1981','1982','1983','1984','1985','1986','1987','1988','1989','1990','1991','1992','1993','1994','1995','1996','1997','1998','1999','2000','2001','2002','2003','2004','2005','2006','2007','2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020')
for (i in 1:length(year_wise)) {
  assign(new_names[i], year_wise[[i]])
}
```

```{r}
year_wise
```









```{r}
`1970`
```


```{r}
`2000`
```




## Now i am going to find the military expenditure in each decade ie (1970-1979, 1980-1989, 1990-1999, 2000-2009, 2010-2019)


```{r}
decade_1970_1979 = rbind(`1970`,`1971`,`1972`,`1973`,`1974`,`1975`,`1976`,`1977`,`1978`,`1979`)
decade_1970_1979
```

```{r}
decade_1970_1979_2 = aggregate(Military.expenditure..current.USD. ~ country, decade_1970_1979, sum)
decade_1970_1979_2
```

```{r}
decade_1970_1979_3 =  arrange(decade_1970_1979_2, -Military.expenditure..current.USD.)
decade_1970_1979_3
```
```{r}
decade_1970_1979_4 = head(decade_1970_1979_3, 10)
decade_1970_1979_4
```

```{r}

decade_1970_1979_plot  = ggplot(decade_1970_1979_4, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Highest 10 Countries Military Spending in the Decade 1970 - 1979') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


decade_1970_1979_plot.labs = decade_1970_1979_plot + labs(title = "Highest 10 Countries Military Spending in the Decade 1970 - 1979", x = "Country", y = "Military Expenditure in US Dollars")
decade_1970_1979_plot.labs
```


```{r}
decade_1980_1989 = rbind(`1980`,`1981`,`1982`,`1983`,`1984`,`1985`,`1986`,`1987`,`1988`,`1989`)
decade_1980_1989_2 = aggregate(Military.expenditure..current.USD. ~ country, decade_1980_1989, sum)
decade_1980_1989_3 =  arrange(decade_1980_1989_2, -Military.expenditure..current.USD.)
decade_1980_1989_4 = head(decade_1980_1989_3, 10)


# Bar Plot
decade_1980_1989_plot  = ggplot(decade_1980_1989_4, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Highest 10 Countries Military Spending in the Decade 1980 - 1989') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


decade_1980_1989_plot.labs = decade_1980_1989_plot + labs(title = "Highest 10 Countries Military Spending in the Decade 1980 - 1989", x = "Country", y = "Military Expenditure in US Dollars")
decade_1980_1989_plot.labs
```


```{r}
decade_1990_1999 = rbind(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`)
decade_1990_1999_2 = aggregate(Military.expenditure..current.USD. ~ country, decade_1990_1999, sum)
decade_1990_1999_3 =  arrange(decade_1990_1999_2, -Military.expenditure..current.USD.)
decade_1990_1999_4 = head(decade_1990_1999_3, 10)


# Bar Plot
decade_1990_1999_plot  = ggplot(decade_1990_1999_4, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Highest 10 Countries Military Spending in the Decade 1990 - 1999') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


decade_1990_1999_plot.labs = decade_1990_1999_plot + labs(title = "Highest 10 Countries Military Spending in the Decade 1990 - 1999", x = "Country", y = "Military Expenditure in US Dollars")
decade_1990_1999_plot.labs
```


```{r}
decade_2000_2009 = rbind(`2000`,`2001`,`2002`,`2003`,`2004`,`2005`,`2006`,`2007`,`2008`,`2009`)
decade_2000_2009_2 = aggregate(Military.expenditure..current.USD. ~ country, decade_2000_2009, sum)
decade_2000_2009_3 =  arrange(decade_2000_2009_2, -Military.expenditure..current.USD.)
decade_2000_2009_4 = head(decade_2000_2009_3, 10)


# Bar Plot
decade_2000_2009_plot  = ggplot(decade_2000_2009_4, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Highest 10 Countries Military Spending in the Decade 2000 - 2009') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


decade_2000_2009_plot.labs = decade_2000_2009_plot + labs(title = "Highest 10 Countries Military Spending in the Decade 2000 - 2009", x = "Country", y = "Military Expenditure in US Dollars")
decade_2000_2009_plot.labs
```


```{r}
decade_2010_2019 = rbind(`2010`,`2011`,`2012`,`2013`,`2014`,`2015`,`2016`,`2017`,`2018`,`2019`)
decade_2010_2019_2 = aggregate(Military.expenditure..current.USD. ~ country, decade_2010_2019, sum)
decade_2010_2019_3 =  arrange(decade_2010_2019_2, -Military.expenditure..current.USD.)
decade_2010_2019_4 = head(decade_2010_2019_3, 10)


# Bar Plot
decade_2010_2019_plot  = ggplot(decade_2010_2019_4, aes(x= reorder(country, Military.expenditure..current.USD. ) , y=Military.expenditure..current.USD., fill = country)) +
geom_col()+ ggtitle('Highest 10 Countries Military Spending in the Decade 2010 - 2019') + coord_flip() + 
theme(legend.position = 'None', axis.text.y = element_text(size = 10))


decade_2010_2019_plot.labs = decade_2010_2019_plot + labs(title = "Highest 10 Countries Military Spending in the Decade 2010 - 2019", x = "Country", y = "Military Expenditure in US Dollars")
decade_2010_2019_plot.labs
```

































